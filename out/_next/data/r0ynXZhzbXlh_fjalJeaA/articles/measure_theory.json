{"pageProps":{"article":{"header":{"slug":"measure_theory","matter":{"title":"機械学習のための測度論/ルベーグ積分論(1)","createdAt":"2021-05-16T1634:53.325Z","tags":["machine_learinig","math"]},"excerpt":"なぜ測度論/ルベーグ積分論を学ぶのか 測度論は集合の大きさの「測り方」を考えるもの、ルベーグ積分論は、測度を用いた新たな積分を定義するものです。 大学の数学科に進むと必ず触れることになる分野で、函数解析学や確率論などに繋がるものとなっています。 機械学習の分野でも、測度論的確率論の視点から俯瞰することがトレンドになった..."},"bodyMdText":"\n## なぜ測度論/ルベーグ積分論を学ぶのか\n\n測度論は集合の大きさの「測り方」を考えるもの、ルベーグ積分論は、測度を用いた新たな積分を定義するものです。  \n大学の数学科に進むと必ず触れることになる分野で、函数解析学や確率論などに繋がるものとなっています。  \n機械学習の分野でも、測度論的確率論の視点から俯瞰することがトレンドになったこともあり、抽象的な議論が多いながら、  \n実用的な分野でもよく用いられる分野です。では機械学習の理解には測度論やルベーグ積分の理解は必須なのでしょうか？  \n答えは否です。機械学習を理解する上で測度論の知識は仮定されませんし、実際よくある機械学習の入門書には測度論のことなど 1mm も書いてません。(書いてあるやつあったらごめんなさい)  \nですが、将来的に会社の R&D 部署などで機械学習関係の研究をすることになる際など、機械学習の論文を読み漁る可能性がある人は測度論や確率論について理解しておいた方がいいと思い、本記事を描こうと思いました。\n\n使う必要がない人でも、測度論やルベーグ積分論は大学数学の中でも個人的にとっつきやすい気がしますし、この記事で軽く触って興味を持ったら本を読んでみたりしてくれたら嬉しいです。(おすすめの著書のリンク貼っておきます。)\n\n## 測度論とは？\n\nまず測度論についてざっと説明しておきます。測度論では名前の通り「測度」という概念について考えるのですが、この測度というのは、集合の大きさを測る「ものさし」を表します。例えば、集合として、<img src=\"https://latex.codecogs.com/gif.latex?\\Omega&space;=&space;\\{1,&space;2,&space;3,&space;4,&space;5,&space;6\\}\">というものを考えます。\nこの集合の大きさは、要素の個数である 6 とするのが妥当でしょう。ですが、<img src=\"https://latex.codecogs.com/gif.latex?I&space;=&space;[0,&space;1]\">という集合はどうでしょう？理系の一回生程度の授業で扱うと思いますが、0 から 1 の間の実数全体の集合の個数は非可算無限個であることが知られており、\nこのように実数の区間の要素の個数はどの区間を用意しても無限個となり、集合の大きさとしては不適切となるのがわかると思います。なので、このような集合に対しては別の方法で「大きさ」を定めるわけですが、この「大きさ」の測り方を「測度」という関数で表します。(大きさを要素の個数とする、という測度も存在し、counting measure と呼びます)\n\nさて、上のようなある意味で「連続」な集合に対する測度の定め方ですが、例えば「面積」という考え方があります。例として、<img src=\"https://latex.codecogs.com/gif.latex?I^2&space;=&space;[0,&space;1]&space;*&space;[0,&space;1]\">という集合を考えます。  \nこれを x-y 平面上に描画すると、一辺の長さが 1 の正方形となります。そこで、このような 2 次元平面上の測度として、集合の面積を考えましょう。先ほどの![](https://latex.codecogs.com/gif.latex?I^2)については、測度を適用した値は 1 となります。  \nこの 2 次元平面上の面積は測度の定義を満たすことが知られており、n 次元平面上の測度も同様に n 次元面積として定義できます。この意味での測度に「ちょっとした細工」を加えたものが、のちのルベーグ積分論で出てくる「ルベーグ測度」と呼ばれるものです。\n\n## ルベーグ積分とは？\n\nでは、次にルベーグ積分のことを考えようと思うのですが、その前に、高校でも習うリーマン積分について軽く復習しておきましょう。\n\n<img src=\"https://w3e.kanazawa-it.ac.jp/math/category/sekibun/image/riemann-sum.gif\">\n\n以下の図で、<img src=\"https://latex.codecogs.com/gif.latex?\\int_a^b&space;f(x)dx\">を計算したいとしましょう。曲線について積分したいときは、積分範囲を微小な区間で区切ってできた長方形部分(図の赤い部分)を足し合わせたものについて、微小区間の長さの 0 への極限を考えれば計算できます。  \n図の通りだと<img src=\"https://latex.codecogs.com/gif.latex?f(x)\">は連続関数ですが、ある有限個の不連続点が存在しても、区間をその不連続点で区切り、最後に有限和を取れば同様に計算可能です。  \nですが、不連続点が無限個ある場合はどうしましょう？次の関数と区間を考えてみましょう。\n\n<img src=\"https://latex.codecogs.com/gif.latex?1_{\\mathbb{Q}}(x)&space;=&space;\\begin{cases}&space;1&space;\\hspace{8mm}&space;(\\rm{if}&space;\\hspace{1mm}&space;x&space;\\in&space;\\mathbb{Q})&space;\\\\&space;0&space;\\hspace{8mm}&space;(\\rm{if}&space;\\hspace{1mm}&space;x&space;\\notin&space;\\mathbb{Q})&space;\\end{cases}\">\n\nこの関数の意味としては、<img src=\"https://latex.codecogs.com/gif.latex?x\">が有理数の時は 1, 無理数のときは 0 をとるような関数ですね。(<img src=\"https://latex.codecogs.com/gif.latex?\\mathbb{Q}\">は有理数全体の集合です)  \n<img src=\"https://latex.codecogs.com/gif.latex?I\">上には有理数点は可算無限個存在することが知られています。また、この<img src=\"https://latex.codecogs.com/gif.latex?1_{\\mathbb{Q}}(x)\">を連続関数の時と同様、長方形近似の極限として考えます。この時、有理数と無理数は稠密に敷き詰められているという事実から、この極限値は存在せず、リーマン積分はできないことがわかります。\n\nこれはリーマン積分できない関数のたった一例ですが、このような関数の積分を考えるためにルベーグ積分というものを導入します。  \nリーマン積分では積分範囲を十分小さく分割して、それを横の長さとするような長方形の面積として考えました。ルベーグ積分では、先ほど軽く述べたルベーグ測度で積分範囲を小さい集合に分割してそれぞれの「大きさ」を測り、それに各集合上での関数の値をかけたものを足し合わせます。ここで、以下のような気持ち悪い関数を考えます。\n\n![irregular_sin](/Images/measure_theory/irregular_sin.png)\n\nこれは、sinx 上の点のうち、二つの点をランダムに変更した関数です。この関数をルベーグ積分しようと思った時、二つの非連続点は面積に関係しない(面積としての重みがない、とも言える)ため、普通に sinx を積分するのと変わらない、と言えます。このことを測度論の世界では以下のように表現します。\n\n<img src=\"https://latex.codecogs.com/gif.latex?f(x)&space;=&space;\\sin&space;(x)&space;\\&space;\\&space;\\&space;\\&space;\\mathrm{almost&space;\\&space;everywhere\">\n\nこの almost everywhere という考え方はルベーグ積分論ではとても重要で、今回のようにある積分しやすい関数 f と気持ち悪い関数 g が存在して g を積分したいと思った時、f と g が<img src=\"https://latex.codecogs.com/gif.latex?f(x)&space;=&space;g(x)&space;\\&space;\\&space;\\&space;\\&space;\\mathrm{almost&space;\\&space;everywhere}\">\nという関係を満たす時、f を積分すればよい、ということになります。  \n(ちなみに、先ほどの気持ち悪い sinx の不連続点のように、「重み」を持たない集合のことを(測度 μ で測っても 0 という意味で)μ-0 集合とか言ったりします)\n\nさて、先の不連続点が無限個あるような関数の積分を再び考えてみましょう。  \n実は、ルベーグ測度 μ について、有理数全体の集合 Q は、μ-0 集合ということが知られています。つまり、\n<img src=\"https://latex.codecogs.com/gif.latex?1_\\mathbb{Q}(x)&space;=&space;0&space;\\&space;\\&space;\\&space;\\&space;\\mathrm{almost&space;\\&space;everywhere}\">\nが成り立っているため、\n<img src=\"https://latex.codecogs.com/gif.latex?\\int_0^{1}&space;1_\\mathbb{Q}&space;\\&space;d\\mu&space;=&space;\\int_0^1&space;0&space;\\&space;d\\mu&space;=&space;0\">\nとなるわけです。  \nこの関数はリーマン積分は出来ないので、ルベーグ積分ではリーマン積分よりも積分できる関数が多いわけです。\n\n## 終わりに\n\n今回は測度論、及びルベーグ積分論の有用性について書きました。最後にルベーグ積分できる関数はリーマン積分より多いと書きましたが、これによる利点がまだまだあります。  \nですがそれはまた追々...。\n","tocMdText":"- [なぜ測度論/ルベーグ積分論を学ぶのか](#%E3%81%AA%E3%81%9C%E6%B8%AC%E5%BA%A6%E8%AB%96%E3%83%AB%E3%83%99%E3%83%BC%E3%82%B0%E7%A9%8D%E5%88%86%E8%AB%96%E3%82%92%E5%AD%A6%E3%81%B6%E3%81%AE%E3%81%8B)\n- [測度論とは？](#%E6%B8%AC%E5%BA%A6%E8%AB%96%E3%81%A8%E3%81%AF)\n- [ルベーグ積分とは？](#%E3%83%AB%E3%83%99%E3%83%BC%E3%82%B0%E7%A9%8D%E5%88%86%E3%81%A8%E3%81%AF)\n- [終わりに](#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB)"}},"__N_SSG":true}